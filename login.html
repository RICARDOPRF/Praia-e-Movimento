<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Entrar — Praia & Movimento</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital@1&family=Plus+Jakarta+Sans:wght@400;600&display=swap" rel="stylesheet">
  <script>
    tailwind.config = { theme: { extend: { colors: { sand: "#F7E9D7", ink: "#0C0C0C", gold: "#C9A44F" } } } }
  </script>
</head>
<body class="bg-sand text-ink font-sans min-h-screen flex items-center justify-center">

  <div class="bg-white w-full max-w-md rounded-[3rem] p-12 shadow-xl mx-6">
    <header class="text-center mb-10">
      <a href="index.html" class="font-serif text-2xl font-bold italic block mb-2">Praia & Movimento</a>
      <p class="text-black/40 text-[10px] uppercase tracking-[0.2em] font-bold">Acesse sua conta</p>
    </header>

    <form id="form-login" class="space-y-6">
      <div>
        <label class="text-[10px] uppercase font-bold text-black/30 tracking-widest ml-1">E-mail</label>
        <input type="email" id="login-email" class="w-full border-b border-black/10 py-3 outline-none focus:border-gold transition" required>
      </div>
      
      <div>
        <label class="text-[10px] uppercase font-bold text-black/30 tracking-widest ml-1">Senha</label>
        <input type="password" id="login-senha" class="w-full border-b border-black/10 py-3 outline-none focus:border-gold transition" required>
      </div>

      <button type="submit" id="btn-entrar" class="w-full bg-ink text-white py-4 rounded-full font-bold tracking-widest hover:bg-gold transition shadow-lg transform hover:-translate-y-0.5">
        ENTRAR
      </button>
    </form>
    
    <div class="mt-10 text-center space-y-4">
      <p class="text-sm text-black/40">Novo por aqui? <a href="cadastro.html" class="text-ink font-bold underline">Criar conta</a></p>
      <a href="https://wa.me/555197365965?text=Esqueci%20minha%20senha" target="_blank" class="block text-[10px] uppercase tracking-widest text-black/30 hover:text-gold transition">
        Esqueceu a senha? Fale connosco
      </a>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
    import { firebaseConfig, ADMIN_UID } from "./site.js"; 

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    const form = document.getElementById('form-login');
    const btn = document.getElementById('btn-entrar');

    form.onsubmit = async (e) => {
      e.preventDefault();
      
      const email = document.getElementById('login-email').value;
      const senha = document.getElementById('login-senha').value;

      btn.innerText = "VERIFICANDO...";
      btn.disabled = true;

      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, senha);
        const user = userCredential.user;

        // Criamos o objeto do usuário para o LocalStorage
        const dadosUsuario = {
          uid: user.uid,
          email: user.email.toLowerCase(),
          nome: user.displayName || "Cliente"
        };

        localStorage.setItem("usuario_logado", JSON.stringify(dadosUsuario));

        // --- REDIRECIONAMENTO CORRIGIDO ---
        const EMAIL_ADMIN = "pauloricardo96@live.com";
        
        if (user.uid === ADMIN_UID || user.email.toLowerCase() === EMAIL_ADMIN) {
          // Redireciona para admin.html (o arquivo que criamos anteriormente)
          window.location.href = "admin.html";
        } else {
          window.location.href = "index.html";
        }

      } catch (error) {
        btn.innerText = "ENTRAR";
        btn.disabled = false;
        
        console.error("Erro de login:", error.code);
        
        if (error.code === 'auth/invalid-credential' || error.code === 'auth/wrong-password' || error.code === 'auth/user-not-found') {
          alert("E-mail ou senha incorretos.");
        } else {
          alert("Erro ao acessar. Verifique se o e-mail está cadastrado no Firebase.");
        }
      }
    };
  </script>

</body>
</html>